<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Entitlement Items - Crescat</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <style>
    :root {
      --bg-main: hsl(204, 77%, 12%);
      --bg-sidebar: hsl(205, 64%, 14%);
      --bg-content: hsl(204, 77%, 12%);
      --bg-hover: hsl(205, 57%, 16%);
      --bg-active: hsl(205, 47%, 19%);
      --bg-input: hsl(205, 68%, 14%);
      --bg-row: hsl(204, 77%, 12%);
      --bg-row-alt: hsl(205, 64%, 14%);
      --bg-row-hover: hsl(205, 57%, 16%);
      --text-default: hsl(205, 42%, 84%);
      --text-soft: hsl(205, 16%, 57%);
      --text-inverted: hsl(204, 77%, 12%);
      --border-default: hsl(203, 44%, 20%);
      --border-soft: hsl(204, 52%, 17%);
      --color-success: hsl(151, 61%, 43%);
      --color-primary: hsl(205, 69%, 33%);
      --color-pending: hsl(44, 88%, 66%);
      --color-warning: hsl(0, 88%, 66%);
      --color-highlight: #45A4E4;
    }
    body { background: var(--bg-main); color: var(--text-default); font-family: 'Inter', sans-serif; font-size: 14px; }
    * { scrollbar-width: thin; scrollbar-color: var(--border-default) transparent; }
    ::-webkit-scrollbar { width: 6px; height: 6px; }
    ::-webkit-scrollbar-track { background: transparent; }
    ::-webkit-scrollbar-thumb { background: var(--border-default); border-radius: 9999px; }
    .btn-primary { background: var(--color-primary); color: #fff; font-weight: 500; text-transform: capitalize; border-radius: 6px; padding: 0 16px; height: 30px; display: inline-flex; align-items: center; gap: 6px; transition: all 0.15s; }
    .btn-primary:hover { filter: brightness(1.15); }
    .btn-sm { height: 26px; padding: 0 10px; font-size: 12px; }
    .btn-lg { height: 38px; padding: 0 20px; font-size: 15px; }
    .btn-success { background: var(--color-success); color: #fff; font-weight: 500; text-transform: capitalize; border-radius: 6px; padding: 0 16px; height: 30px; display: inline-flex; align-items: center; gap: 6px; transition: all 0.15s; }
    .btn-success:hover { filter: brightness(1.15); }
    .btn-warning { background: var(--color-warning); color: #fff; font-weight: 500; text-transform: capitalize; border-radius: 6px; padding: 0 16px; height: 30px; display: inline-flex; align-items: center; gap: 6px; transition: all 0.15s; }
    .btn-warning:hover { filter: brightness(1.15); }
    .btn-ghost { background: transparent; color: var(--text-default); font-weight: 500; border-radius: 6px; padding: 0 12px; height: 30px; display: inline-flex; align-items: center; gap: 6px; border: 1px solid var(--border-default); transition: all 0.15s; }
    .btn-ghost:hover { background: var(--bg-hover); }
    .input-field { background: var(--bg-input); border: 1px solid var(--border-default); color: var(--text-default); border-radius: 6px; padding: 6px 12px; font-size: 14px; font-family: 'Inter', sans-serif; outline: none; transition: border-color 0.15s; }
    .input-field:focus { border-color: var(--color-primary); }
    .badge-active { display: inline-flex; align-items: center; gap: 4px; padding: 2px 10px; border-radius: 9999px; font-size: 12px; font-weight: 500; color: hsl(151, 61%, 43%); background: hsla(151, 61%, 43%, 0.1); border: 1px solid hsla(151, 61%, 43%, 0.2); }
    .badge-info { display: inline-flex; align-items: center; gap: 4px; padding: 2px 10px; border-radius: 9999px; font-size: 12px; font-weight: 500; color: #45A4E4; background: rgba(69, 164, 228, 0.1); border: 1px solid rgba(69, 164, 228, 0.2); }
    .badge-pending { display: inline-flex; align-items: center; gap: 4px; padding: 2px 10px; border-radius: 9999px; font-size: 12px; font-weight: 500; color: hsl(44, 88%, 66%); background: hsla(44, 88%, 66%, 0.1); border: 1px solid hsla(44, 88%, 66%, 0.2); }
    .badge-warning { display: inline-flex; align-items: center; gap: 4px; padding: 2px 10px; border-radius: 9999px; font-size: 12px; font-weight: 500; color: hsl(0, 88%, 66%); background: hsla(0, 88%, 66%, 0.1); border: 1px solid hsla(0, 88%, 66%, 0.2); }
    .sidebar-link { display: flex; align-items: center; gap: 10px; padding: 7px 16px; border-radius: 6px; color: var(--text-soft); font-size: 13px; font-weight: 500; text-decoration: none; transition: all 0.15s; }
    .sidebar-link:hover { background: var(--bg-hover); color: var(--text-default); }
    .sidebar-link.active { background: var(--bg-active); color: var(--text-default); }
    .category-item { display: flex; align-items: center; justify-content: space-between; padding: 10px 16px; border-radius: 6px; cursor: pointer; transition: all 0.12s; }
    .category-item:hover { background: var(--bg-hover); }
    .category-item.active { background: var(--bg-active); }
  </style>
</head>
<body class="min-h-screen" x-data="entitlementApp()">

  <!-- Navbar -->
  <nav class="fixed top-0 left-0 right-0 z-50 flex items-center justify-between px-4" style="height: 48px; background: var(--bg-sidebar); border-bottom: 1px solid var(--border-default);">
    <div class="flex items-center gap-4">
      <img src="https://crescat.io/assets/logo/logo-white.svg" alt="Crescat" style="height: 12px;">
      <span style="color: var(--text-soft);">|</span>
      <span style="color: var(--text-soft); font-size: 13px;">Midgard Festival 2026</span>
    </div>
    <div class="flex items-center gap-3">
      <span style="color: var(--text-soft); font-size: 13px;">Admin</span>
      <div class="w-8 h-8 rounded-full flex items-center justify-center text-xs font-semibold" style="background: var(--color-primary); color: #fff;">JD</div>
    </div>
  </nav>

  <!-- SIDEBAR -->
  <aside class="fixed top-12 left-0 bottom-0 overflow-y-auto py-4 px-3" style="width:232px; background:var(--bg-sidebar); border-right:1px solid var(--border-default);">
    <div class="mb-4 px-3">
      <p class="text-xs font-semibold uppercase tracking-wider mb-2" style="color:var(--text-soft);">Main</p>
    </div>
    <nav class="flex flex-col gap-1">
      <a href="01-dashboard.html" class="sidebar-link">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="7" height="7" rx="1"/><rect x="14" y="3" width="7" height="7" rx="1"/><rect x="3" y="14" width="7" height="7" rx="1"/><rect x="14" y="14" width="7" height="7" rx="1"/></svg>
        Dashboard
      </a>
      <a href="02-participants.html" class="sidebar-link">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M17 21v-2a4 4 0 00-4-4H5a4 4 0 00-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M23 21v-2a4 4 0 00-3-3.87"/><path d="M16 3.13a4 4 0 010 7.75"/></svg>
        Participants
      </a>
      <a href="04-entitlement-items.html" class="sidebar-link active">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="2" y="7" width="20" height="14" rx="2"/><path d="M16 7V5a2 2 0 00-2-2h-4a2 2 0 00-2 2v2"/></svg>
        Entitlement Items
      </a>
      <a href="05-rules.html" class="sidebar-link">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="22 12 18 12 15 21 9 3 6 12 2 12"/></svg>
        Rules Engine
      </a>
      <a href="06-zones.html" class="sidebar-link">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polygon points="1 6 1 22 8 18 16 22 23 18 23 2 16 6 8 2 1 6"/></svg>
        Zones
      </a>
      <a href="07-checkpoints.html" class="sidebar-link">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 22s-8-4.5-8-11.8A8 8 0 0112 2a8 8 0 018 8.2c0 7.3-8 11.8-8 11.8z"/><circle cx="12" cy="10" r="3"/></svg>
        Checkpoints
      </a>
      <a href="08-allocations.html" class="sidebar-link">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 16V8a2 2 0 00-1-1.73l-7-4a2 2 0 00-2 0l-7 4A2 2 0 003 8v8a2 2 0 001 1.73l7 4a2 2 0 002 0l7-4A2 2 0 0021 16z"/></svg>
        Allocations
      </a>
      <a href="09-credentials.html" class="sidebar-link">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="4" width="18" height="16" rx="2"/><line x1="3" y1="10" x2="21" y2="10"/></svg>
        Credentials
      </a>
      <a href="10-scan-log.html" class="sidebar-link">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8z"/><polyline points="14 2 14 8 20 8"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/></svg>
        Scan Log
      </a>
      <a href="13-schedules.html" class="sidebar-link">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>
        Schedules
      </a>
      <a href="14-equipment.html" class="sidebar-link">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M14.7 6.3a1 1 0 000 1.4l1.6 1.6a1 1 0 001.4 0l3.77-3.77a6 6 0 01-7.94 7.94l-6.91 6.91a2.12 2.12 0 01-3-3l6.91-6.91a6 6 0 017.94-7.94l-3.76 3.76z"/></svg>
        Equipment
      </a>
      <a href="catering.html" class="sidebar-link">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M18 8h1a4 4 0 010 8h-1"/><path d="M2 8h16v9a4 4 0 01-4 4H6a4 4 0 01-4-4V8z"/><line x1="6" y1="1" x2="6" y2="4"/><line x1="10" y1="1" x2="10" y2="4"/><line x1="14" y1="1" x2="14" y2="4"/></svg>
        Catering
      </a>
      <a href="lost-found.html" class="sidebar-link">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/></svg>
        Lost &amp; Found
      </a>
      <a href="crowd-flow.html" class="sidebar-link">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M17 21v-2a4 4 0 00-4-4H5a4 4 0 00-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M23 21v-2a4 4 0 00-3-3.87"/><path d="M16 3.13a4 4 0 010 7.75"/><polyline points="22 4 22 10 16 10"/></svg>
        Crowd Flow
      </a>

      <div class="my-3 mx-3" style="border-top:1px solid var(--border-soft);"></div>
      <p class="text-xs font-semibold uppercase tracking-wider mb-2 px-3" style="color:var(--text-soft);">On-Site</p>

      <a href="11-scanner.html" class="sidebar-link">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M4 7V4h3"/><path d="M20 7V4h-3"/><path d="M4 17v3h3"/><path d="M20 17v3h-3"/><line x1="4" y1="12" x2="20" y2="12"/></svg>
        Scanner
      </a>
      <a href="12-accreditation-office.html" class="sidebar-link">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M3 9l9-7 9 7v11a2 2 0 01-2 2H5a2 2 0 01-2-2z"/><polyline points="9 22 9 12 15 12 15 22"/></svg>
        Accreditation Office
      </a>

      <div class="my-3 mx-3" style="border-top:1px solid var(--border-soft);"></div>
      <p class="text-xs font-semibold uppercase tracking-wider mb-2 px-3" style="color:var(--text-soft);">Self-Service</p>

      <a href="volunteer-onboarding.html" class="sidebar-link">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M16 21v-2a4 4 0 00-4-4H6a4 4 0 00-4 4v2"/><circle cx="9" cy="7" r="4"/><line x1="19" y1="8" x2="19" y2="14"/><line x1="22" y1="11" x2="16" y2="11"/></svg>
        Volunteer Portal
      </a>
      <a href="15-portal.html" class="sidebar-link">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="2" y="3" width="20" height="14" rx="2"/><path d="M8 21h8"/><path d="M12 17v4"/></svg>
        Self-Service Portal
      </a>
    </nav>
  </aside>

  <!-- Main Content -->
  <main class="pt-[48px]" style="margin-left: 232px;">
    <div class="p-6">
      <!-- Page Header -->
      <div class="flex items-center justify-between mb-6">
        <div>
          <h1 class="text-xl font-semibold text-white mb-1">Entitlement Items</h1>
          <p style="color: var(--text-soft); font-size: 13px;">Define the catalog of entitlements available for this festival</p>
        </div>
        <div class="flex items-center gap-3">
          <span style="color: var(--text-soft); font-size: 13px;">18 items across 5 categories</span>
          <button class="btn-primary" @click="showAddItem = true">+ Add Item</button>
        </div>
      </div>

      <!-- Two Panel Layout -->
      <div class="flex gap-4" style="min-height: calc(100vh - 160px);">

        <!-- Categories Panel -->
        <div class="flex-shrink-0" style="width: 260px;">
          <div class="rounded-md" style="background: var(--bg-sidebar); border: 1px solid var(--border-default); border-radius: 6px;">
            <div class="flex items-center justify-between px-4 py-3" style="border-bottom: 1px solid var(--border-default);">
              <span class="text-white font-medium text-sm">Categories</span>
              <span class="badge-info" style="font-size: 11px;">5</span>
            </div>
            <div class="py-2 px-2">
              <template x-for="cat in categories" :key="cat.id">
                <div class="category-item" :class="{ 'active': selectedCategory === cat.id }" @click="selectedCategory = cat.id">
                  <div class="flex items-center gap-3">
                    <span class="text-base" x-text="cat.icon"></span>
                    <span class="text-sm" :class="selectedCategory === cat.id ? 'text-white font-medium' : ''" x-text="cat.name"></span>
                  </div>
                  <span class="text-xs px-2 py-0.5 rounded-full" style="background: var(--bg-active); color: var(--text-soft);" x-text="cat.count"></span>
                </div>
              </template>
            </div>
            <div class="px-2 pb-3 pt-1">
              <button class="w-full text-left px-4 py-2 rounded-md text-sm transition-colors" style="color: var(--color-highlight); border: 1px dashed var(--border-default);" @click="showAddCategory = true" onmouseover="this.style.background='var(--bg-hover)'" onmouseout="this.style.background='transparent'">+ Add Category</button>
            </div>
          </div>
        </div>

        <!-- Items Panel -->
        <div class="flex-1 min-w-0">
          <div class="rounded-md" style="background: var(--bg-sidebar); border: 1px solid var(--border-default); border-radius: 6px;">
            <!-- Category Header -->
            <div class="flex items-center justify-between px-5 py-3" style="border-bottom: 1px solid var(--border-default);">
              <div class="flex items-center gap-3">
                <span class="text-lg" x-text="currentCategory.icon"></span>
                <h2 class="text-white font-semibold text-base" x-text="currentCategory.name"></h2>
                <span class="badge-info" x-text="currentCategory.count + ' items'"></span>
              </div>
              <div class="flex items-center gap-2">
                <button class="btn-ghost btn-sm">
                  <span style="font-size: 11px;">&#9998;</span> Edit
                </button>
                <button class="btn-ghost btn-sm" style="border-color: hsla(0, 88%, 66%, 0.3); color: hsl(0, 88%, 66%);">
                  <span style="font-size: 11px;">&#10005;</span> Delete
                </button>
              </div>
            </div>

            <!-- Items Table -->
            <div class="overflow-x-auto">
              <table class="w-full">
                <thead>
                  <tr style="border-bottom: 1px solid var(--border-default);">
                    <th class="text-left px-5 py-3 text-xs font-semibold uppercase tracking-wider" style="color: var(--text-soft);">Name</th>
                    <th class="text-left px-4 py-3 text-xs font-semibold uppercase tracking-wider" style="color: var(--text-soft);">Type</th>
                    <th class="text-left px-4 py-3 text-xs font-semibold uppercase tracking-wider" style="color: var(--text-soft);">Per Day</th>
                    <th class="text-left px-4 py-3 text-xs font-semibold uppercase tracking-wider" style="color: var(--text-soft);">Inventory</th>
                    <th class="text-left px-4 py-3 text-xs font-semibold uppercase tracking-wider" style="color: var(--text-soft);">Zones</th>
                    <th class="text-left px-4 py-3 text-xs font-semibold uppercase tracking-wider" style="color: var(--text-soft);">Status</th>
                    <th class="text-right px-5 py-3 text-xs font-semibold uppercase tracking-wider" style="color: var(--text-soft);">Actions</th>
                  </tr>
                </thead>
                <tbody>
                  <template x-for="(item, index) in currentItems" :key="item.id">
                    <tr :style="index % 2 === 0 ? 'background: var(--bg-row)' : 'background: var(--bg-row-alt)'" onmouseover="this.style.background='var(--bg-row-hover)'" :onmouseout="index % 2 === 0 ? 'this.style.background=`var(--bg-row)`' : 'this.style.background=`var(--bg-row-alt)`'" class="transition-colors" style="border-bottom: 1px solid var(--border-soft);">
                      <td class="px-5 py-3">
                        <div class="flex items-center gap-2">
                          <span class="text-white font-medium text-sm" x-text="item.name"></span>
                        </div>
                      </td>
                      <td class="px-4 py-3">
                        <span class="badge-info" style="font-size: 11px; text-transform: capitalize;" x-text="item.type"></span>
                      </td>
                      <td class="px-4 py-3 text-sm">
                        <template x-if="item.perDay">
                          <span class="flex items-center gap-1" style="color: var(--color-success);">&#10003; <span x-text="item.perDayAmount"></span></span>
                        </template>
                        <template x-if="item.totalAmount && !item.perDay">
                          <span style="color: var(--text-soft);" x-text="item.totalAmount + ' total'"></span>
                        </template>
                        <template x-if="!item.perDay && !item.totalAmount">
                          <span style="color: var(--text-soft);">&mdash;</span>
                        </template>
                      </td>
                      <td class="px-4 py-3 text-sm">
                        <template x-if="item.inventory">
                          <div>
                            <span class="text-white" x-text="item.inventory.total + ' total'"></span>
                            <span style="color: var(--text-soft);" x-text="'(' + item.inventory.out + ' out, ' + (item.inventory.total - item.inventory.out) + ' avail)'"></span>
                          </div>
                        </template>
                        <template x-if="!item.inventory">
                          <span style="color: var(--text-soft);">&mdash;</span>
                        </template>
                      </td>
                      <td class="px-4 py-3 text-sm">
                        <template x-if="item.zones && item.zones.length > 0">
                          <div class="flex flex-wrap gap-1">
                            <template x-for="zone in item.zones" :key="zone">
                              <span class="inline-block px-2 py-0.5 rounded text-xs" style="background: var(--bg-active); color: var(--text-default);" x-text="zone"></span>
                            </template>
                          </div>
                        </template>
                        <template x-if="!item.zones || item.zones.length === 0">
                          <span style="color: var(--text-soft);">&mdash;</span>
                        </template>
                      </td>
                      <td class="px-4 py-3">
                        <span class="badge-active" x-text="item.status"></span>
                      </td>
                      <td class="px-5 py-3 text-right">
                        <div class="flex items-center justify-end gap-1">
                          <button class="w-7 h-7 rounded flex items-center justify-center transition-colors" style="color: var(--text-soft);" onmouseover="this.style.background='var(--bg-hover)';this.style.color='var(--text-default)'" onmouseout="this.style.background='transparent';this.style.color='var(--text-soft)'" title="Edit" @click.stop="showToast('Edit: ' + item.name + ' (coming soon)')">&#9998;</button>
                          <button class="w-7 h-7 rounded flex items-center justify-center transition-colors" style="color: var(--text-soft);" onmouseover="this.style.background='var(--bg-hover)';this.style.color='var(--text-default)'" onmouseout="this.style.background='transparent';this.style.color='var(--text-soft)'" title="Duplicate" @click.stop="const copy = {...item, id: Date.now(), name: item.name + ' (copy)'}; items[selectedCategory].push(copy); const cat = categories.find(c => c.id === selectedCategory); if(cat) cat.count++;">&#9851;</button>
                          <button class="w-7 h-7 rounded flex items-center justify-center transition-colors" style="color: var(--text-soft);" onmouseover="this.style.background='hsla(0,88%,66%,0.1)';this.style.color='hsl(0,88%,66%)'" onmouseout="this.style.background='transparent';this.style.color='var(--text-soft)'" title="Delete" @click.stop="confirmAction = {title: 'Delete Item', message: 'Delete ' + item.name + '?', action: () => { items[selectedCategory].splice(index, 1); const cat = categories.find(c => c.id === selectedCategory); if(cat) cat.count--; }}">&#10005;</button>
                        </div>
                      </td>
                    </tr>
                  </template>
                </tbody>
              </table>
            </div>

            <!-- Add Item Row -->
            <div class="px-5 py-3" style="border-top: 1px solid var(--border-default);">
              <button class="text-sm transition-colors" style="color: var(--color-highlight);" @click="showAddItem = true" onmouseover="this.style.opacity='0.8'" onmouseout="this.style.opacity='1'">+ Add item to <span x-text="currentCategory.name"></span></button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </main>

  <!-- Add Item Modal -->
  <div x-show="showAddItem" x-cloak class="fixed inset-0 z-[100] flex items-center justify-center" style="background: rgba(0,0,0,0.6);" @click.self="showAddItem = false" x-transition>
    <div class="w-full max-w-lg rounded-lg shadow-2xl overflow-hidden" style="background: var(--bg-sidebar); border: 1px solid var(--border-default); border-radius: 6px;" @click.stop>
      <div class="flex items-center justify-between px-6 py-4" style="border-bottom: 1px solid var(--border-default);">
        <h3 class="text-white font-semibold text-base">Add Entitlement Item</h3>
        <button class="w-7 h-7 rounded flex items-center justify-center transition-colors" style="color: var(--text-soft);" @click="showAddItem = false" onmouseover="this.style.background='var(--bg-hover)'" onmouseout="this.style.background='transparent'">&#10005;</button>
      </div>
      <div class="px-6 py-5 space-y-4 max-h-[70vh] overflow-y-auto">
        <!-- Name -->
        <div>
          <label class="block text-xs font-medium mb-1.5" style="color: var(--text-soft);">Name</label>
          <input type="text" class="input-field w-full" placeholder="e.g. VIP Access Pass" x-model="newItem.name">
        </div>
        <!-- Category -->
        <div>
          <label class="block text-xs font-medium mb-1.5" style="color: var(--text-soft);">Category</label>
          <select class="input-field w-full" x-model="newItem.category">
            <template x-for="cat in categories" :key="cat.id">
              <option :value="cat.id" x-text="cat.name"></option>
            </template>
          </select>
        </div>
        <!-- Item Type -->
        <div>
          <label class="block text-xs font-medium mb-2" style="color: var(--text-soft);">Item Type</label>
          <div class="grid grid-cols-2 gap-2">
            <template x-for="t in itemTypes" :key="t.id">
              <label class="flex items-start gap-3 p-3 rounded-md cursor-pointer transition-colors" :style="newItem.type === t.id ? 'background: var(--bg-active); border: 1px solid var(--color-primary)' : 'background: var(--bg-input); border: 1px solid var(--border-default)'" @click="newItem.type = t.id">
                <input type="radio" name="itemType" :value="t.id" x-model="newItem.type" class="mt-0.5 accent-blue-500">
                <div>
                  <div class="text-sm font-medium text-white" x-text="t.label"></div>
                  <div class="text-xs mt-0.5" style="color: var(--text-soft);" x-text="t.description"></div>
                </div>
              </label>
            </template>
          </div>
        </div>
        <!-- Type-specific fields -->
        <!-- Access: Zone multi-select -->
        <div x-show="newItem.type === 'access'" x-transition>
          <label class="block text-xs font-medium mb-1.5" style="color: var(--text-soft);">Zones (multi-select)</label>
          <div class="grid grid-cols-2 gap-1.5">
            <template x-for="zone in availableZones" :key="zone">
              <label class="flex items-center gap-2 px-3 py-2 rounded cursor-pointer transition-colors" style="background: var(--bg-input);" onmouseover="this.style.background='var(--bg-hover)'" onmouseout="this.style.background='var(--bg-input)'">
                <input type="checkbox" class="accent-blue-500" :value="zone" x-model="newItem.zones">
                <span class="text-sm" x-text="zone"></span>
              </label>
            </template>
          </div>
        </div>
        <!-- Consumable: Quantity + Per Day -->
        <div x-show="newItem.type === 'consumable'" x-transition>
          <div class="grid grid-cols-2 gap-3">
            <div>
              <label class="block text-xs font-medium mb-1.5" style="color: var(--text-soft);">Quantity</label>
              <input type="number" class="input-field w-full" placeholder="e.g. 3" min="1" x-model="newItem.quantity">
            </div>
            <div>
              <label class="block text-xs font-medium mb-1.5" style="color: var(--text-soft);">Per Day?</label>
              <div class="flex items-center gap-3 h-[34px]">
                <label class="flex items-center gap-2 cursor-pointer">
                  <input type="checkbox" class="accent-blue-500" x-model="newItem.perDay">
                  <span class="text-sm">Resets daily</span>
                </label>
              </div>
            </div>
          </div>
        </div>
        <!-- Returnable: Quantity + Total Inventory -->
        <div x-show="newItem.type === 'returnable'" x-transition>
          <div class="grid grid-cols-2 gap-3">
            <div>
              <label class="block text-xs font-medium mb-1.5" style="color: var(--text-soft);">Qty Per Person</label>
              <input type="number" class="input-field w-full" placeholder="e.g. 1" min="1" x-model="newItem.quantity">
            </div>
            <div>
              <label class="block text-xs font-medium mb-1.5" style="color: var(--text-soft);">Total Inventory</label>
              <input type="number" class="input-field w-full" placeholder="e.g. 50" min="1" x-model="newItem.totalInventory">
            </div>
          </div>
        </div>
        <!-- Description -->
        <div>
          <label class="block text-xs font-medium mb-1.5" style="color: var(--text-soft);">Description</label>
          <textarea class="input-field w-full" rows="3" placeholder="Optional description of this item..." x-model="newItem.description"></textarea>
        </div>
        <!-- Schedule -->
        <div>
          <label class="block text-xs font-medium mb-1.5" style="color: var(--text-soft);">Schedule (optional)</label>
          <select class="input-field w-full" x-model="newItem.schedule">
            <option value="">No schedule (always valid)</option>
            <option value="weekend">Festival Weekend (Jul 14 - 17)</option>
            <option value="buildup">Build-up (Jul 10 - 13)</option>
            <option value="teardown">Teardown (Jul 18 - 20)</option>
            <option value="full">Full Event (Jul 10 - 20)</option>
          </select>
        </div>
      </div>
      <div class="flex items-center justify-end gap-3 px-6 py-4" style="border-top: 1px solid var(--border-default);">
        <button class="btn-ghost" @click="showAddItem = false">Cancel</button>
        <button class="btn-success" @click="if(!newItem.name.trim()) return;
          const id = Date.now();
          const item = {
            id: id,
            name: newItem.name,
            type: newItem.type,
            perDay: newItem.perDay,
            perDayAmount: newItem.perDay ? newItem.quantity + '/day' : null,
            totalAmount: !newItem.perDay && newItem.type === 'consumable' ? parseInt(newItem.quantity) : null,
            inventory: newItem.type === 'returnable' || newItem.type === 'onetime' ? {total: parseInt(newItem.totalInventory), out: 0} : null,
            zones: newItem.type === 'access' ? [...newItem.zones] : [],
            status: 'Active'
          };
          if(!items[newItem.category]) items[newItem.category] = [];
          items[newItem.category].push(item);
          const cat = categories.find(c => c.id === newItem.category);
          if(cat) cat.count++;
          newItem = {name:'', category: selectedCategory, type:'access', perDay:false, quantity:1, totalInventory:50, zones:[], description:'', schedule:''};
          showAddItem = false">Create Item</button>
      </div>
    </div>
  </div>

  <!-- Add Category Modal -->
  <div x-show="showAddCategory" x-cloak class="fixed inset-0 z-[100] flex items-center justify-center" style="background: rgba(0,0,0,0.6);" @click.self="showAddCategory = false" x-transition>
    <div class="w-full max-w-md rounded-lg shadow-2xl overflow-hidden" style="background: var(--bg-sidebar); border: 1px solid var(--border-default); border-radius: 6px;" @click.stop>
      <div class="flex items-center justify-between px-6 py-4" style="border-bottom: 1px solid var(--border-default);">
        <h3 class="text-white font-semibold text-base">Add Category</h3>
        <button class="w-7 h-7 rounded flex items-center justify-center transition-colors" style="color: var(--text-soft);" @click="showAddCategory = false" onmouseover="this.style.background='var(--bg-hover)'" onmouseout="this.style.background='transparent'">&#10005;</button>
      </div>
      <div class="px-6 py-5 space-y-4">
        <div>
          <label class="block text-xs font-medium mb-1.5" style="color: var(--text-soft);">Category Name</label>
          <input type="text" class="input-field w-full" placeholder="e.g. Transportation" x-model="newCategoryName">
        </div>
        <div>
          <label class="block text-xs font-medium mb-1.5" style="color: var(--text-soft);">Icon</label>
          <div class="flex gap-2">
            <template x-for="icon in ['&#127915;','&#127922;','&#128230;','&#128295;','&#9733;','&#127873;','&#128663;','&#127380;']">
              <button class="w-9 h-9 rounded flex items-center justify-center text-lg transition-colors" :style="newCategoryIcon === icon ? 'background: var(--bg-active); border: 2px solid var(--color-primary)' : 'background: var(--bg-input); border: 1px solid var(--border-default)'" @click="newCategoryIcon = icon" onmouseover="this.style.borderColor='var(--color-primary)'" onmouseout="if(newCategoryIcon !== this.textContent.trim()) this.style.borderColor='var(--border-default)'" x-html="icon"></button>
            </template>
          </div>
        </div>
        <div>
          <label class="block text-xs font-medium mb-1.5" style="color: var(--text-soft);">Description</label>
          <textarea class="input-field w-full" rows="2" placeholder="Optional description..."></textarea>
        </div>
      </div>
      <div class="flex items-center justify-end gap-3 px-6 py-4" style="border-top: 1px solid var(--border-default);">
        <button class="btn-ghost" @click="showAddCategory = false">Cancel</button>
        <button class="btn-success" @click="if(!newCategoryName.trim()) return;
          const id = newCategoryName.toLowerCase().replace(/\s+/g, '-');
          categories.push({id: id, name: newCategoryName, count: 0, icon: newCategoryIcon});
          items[id] = [];
          newCategoryName = '';
          newCategoryIcon = 'ðŸŽ«';
          showAddCategory = false">Create Category</button>
      </div>
    </div>
  </div>

  <!-- Help Overlay -->
  <button class="fixed bottom-6 right-6 z-[90] w-10 h-10 rounded-full flex items-center justify-center text-white font-bold shadow-lg transition-transform hover:scale-110" style="background: var(--color-primary);" @click="showHelp = true">?</button>

  <div x-show="showHelp" x-cloak class="fixed inset-0 z-[100] flex items-center justify-center" style="background: rgba(0,0,0,0.6);" @click.self="showHelp = false" x-transition>
    <div class="w-full max-w-lg rounded-lg shadow-2xl overflow-hidden" style="background: var(--bg-sidebar); border: 1px solid var(--border-default); border-radius: 6px;" @click.stop>
      <div class="flex items-center justify-between px-6 py-4" style="border-bottom: 1px solid var(--border-default);">
        <div class="flex items-center gap-2">
          <span class="w-6 h-6 rounded-full flex items-center justify-center text-xs font-bold" style="background: var(--color-primary); color: #fff;">?</span>
          <h3 class="text-white font-semibold text-base">About This Screen</h3>
        </div>
        <button class="w-7 h-7 rounded flex items-center justify-center transition-colors" style="color: var(--text-soft);" @click="showHelp = false" onmouseover="this.style.background='var(--bg-hover)'" onmouseout="this.style.background='transparent'">&#10005;</button>
      </div>
      <div class="px-6 py-5 space-y-4 text-sm leading-relaxed">
        <p>The <strong class="text-white">Entitlement Items</strong> screen is where you define the catalog of things that can be assigned to participants. Items are organized by category and each has a type (access, consumable, returnable, one-time) that determines its behavior.</p>
        <div class="rounded-md p-3" style="background: var(--bg-active); border-left: 3px solid var(--color-highlight);">
          <p class="font-medium text-white mb-1">Workflow Coverage</p>
          <p style="color: var(--text-soft);">This screen covers the <em>Item Catalog Setup</em> workflow from the proposal. It is the foundational step before creating rules or making manual allocations.</p>
        </div>
        <div>
          <p class="font-medium text-white mb-2">Item Types:</p>
          <ul class="space-y-1.5" style="color: var(--text-soft);">
            <li><strong class="text-white">Access</strong> items grant zone entry (e.g., backstage passes)</li>
            <li><strong class="text-white">Consumable</strong> items have quantities that deplete (e.g., meal vouchers)</li>
            <li><strong class="text-white">Returnable</strong> items must be given back (e.g., radios)</li>
            <li><strong class="text-white">One-time</strong> items are collected once (e.g., welcome bags)</li>
          </ul>
        </div>
        <div>
          <p class="font-medium text-white mb-2">Key Interactions:</p>
          <ul class="space-y-1" style="color: var(--text-soft);">
            <li>&#8226; Switch between categories in the left panel</li>
            <li>&#8226; Add new items or categories via the buttons</li>
            <li>&#8226; Edit, duplicate, or delete items from the table</li>
            <li>&#8226; The type-specific form fields change based on your selection</li>
          </ul>
        </div>
        <p style="color: var(--text-soft);">This is the foundation &mdash; define items here before creating rules.</p>
      </div>
      <div class="flex justify-end px-6 py-4" style="border-top: 1px solid var(--border-default);">
        <button class="btn-primary" @click="showHelp = false">Got it</button>
      </div>
    </div>
  </div>

  <!-- CONFIRMATION MODAL -->
  <div x-show="confirmAction" x-transition.opacity class="fixed inset-0 z-[110] flex items-center justify-center" style="background:rgba(0,0,0,0.6);">
    <div @click.stop class="w-full max-w-sm rounded-lg p-6" style="background:var(--bg-sidebar); border:1px solid var(--border-default);">
      <h3 class="font-semibold mb-2 text-white" x-text="confirmAction?.title"></h3>
      <p class="text-sm mb-4" style="color:var(--text-soft);" x-text="confirmAction?.message"></p>
      <div class="flex justify-end gap-2">
        <button class="btn-ghost" @click="confirmAction = null">Cancel</button>
        <button class="btn-warning" @click="confirmAction?.action(); confirmAction = null">Delete</button>
      </div>
    </div>
  </div>

  <!-- TOAST -->
  <div x-show="toast" x-transition class="fixed top-16 right-6 z-[110] px-4 py-2 rounded-md text-sm font-medium" style="background:var(--color-primary); color:white;" x-text="toast"></div>

  <script>
    function entitlementApp() {
      return {
        showAddItem: false,
        showAddCategory: false,
        showHelp: false,
        selectedCategory: 'accreditations',
        toast: null,
        confirmAction: null,
        newCategoryName: '',
        newCategoryIcon: 'ðŸŽ«',
        newItem: {
          name: '',
          category: 'accreditations',
          type: 'access',
          perDay: false,
          quantity: 1,
          totalInventory: 50,
          zones: [],
          description: '',
          schedule: '',
        },
        categories: [
          { id: 'accreditations', name: 'Accreditations', count: 4, icon: 'ðŸŽ«' },
          { id: 'meals', name: 'Meals', count: 3, icon: 'ðŸ²' },
          { id: 'equipment', name: 'Equipment', count: 5, icon: 'ðŸ”§' },
          { id: 'supplies', name: 'Supplies', count: 4, icon: 'ðŸ“¦' },
          { id: 'perks', name: 'Perks', count: 2, icon: 'â˜…' },
        ],
        itemTypes: [
          { id: 'access', label: 'Access', description: 'Grants zone entry via scanning' },
          { id: 'consumable', label: 'Consumable', description: 'Depletes with each use or daily' },
          { id: 'returnable', label: 'Returnable', description: 'Must be returned after event' },
          { id: 'onetime', label: 'One-Time', description: 'Collected once, no tracking' },
        ],
        availableZones: ['Backstage', 'VIP Area', 'Production Office', 'Main Stage', 'Green Room', 'Media Center', 'Press Area', 'Artist Lounge', 'Equipment Tent'],
        items: {
          accreditations: [
            { id: 1, name: 'AAA-Access', type: 'access', perDay: false, totalAmount: null, inventory: null, zones: ['Backstage', 'VIP', 'Production', 'Main Stage'], status: 'Active' },
            { id: 2, name: 'Backstage Pass', type: 'access', perDay: false, totalAmount: null, inventory: null, zones: ['Backstage', 'Green Room'], status: 'Active' },
            { id: 3, name: 'VIP Pass', type: 'access', perDay: false, totalAmount: null, inventory: null, zones: ['VIP Area'], status: 'Active' },
            { id: 4, name: 'Media Pass', type: 'access', perDay: false, totalAmount: null, inventory: null, zones: ['Media Center', 'Press Area'], status: 'Active' },
          ],
          meals: [
            { id: 5, name: 'Lunch Voucher', type: 'consumable', perDay: true, perDayAmount: '3/day', totalAmount: null, inventory: null, zones: [], status: 'Active' },
            { id: 6, name: 'Dinner Voucher', type: 'consumable', perDay: true, perDayAmount: '1/day', totalAmount: null, inventory: null, zones: [], status: 'Active' },
            { id: 7, name: 'Drink Token', type: 'consumable', perDay: false, totalAmount: 5, inventory: null, zones: [], status: 'Active' },
          ],
          equipment: [
            { id: 8, name: 'Two-Way Radio', type: 'returnable', perDay: false, totalAmount: null, inventory: { total: 50, out: 38 }, zones: [], status: 'Active' },
            { id: 9, name: 'Headset', type: 'returnable', perDay: false, totalAmount: null, inventory: { total: 30, out: 22 }, zones: [], status: 'Active' },
            { id: 10, name: 'Laptop', type: 'returnable', perDay: false, totalAmount: null, inventory: { total: 10, out: 7 }, zones: [], status: 'Active' },
            { id: 11, name: 'Toolbox', type: 'returnable', perDay: false, totalAmount: null, inventory: { total: 15, out: 4 }, zones: [], status: 'Active' },
            { id: 12, name: 'High-Vis Vest', type: 'returnable', perDay: false, totalAmount: null, inventory: { total: 100, out: 67 }, zones: [], status: 'Active' },
          ],
          supplies: [
            { id: 13, name: 'T-Shirt (Crew)', type: 'onetime', perDay: false, totalAmount: null, inventory: { total: 300, out: 187 }, zones: [], status: 'Active' },
            { id: 14, name: 'Wristband', type: 'onetime', perDay: false, totalAmount: null, inventory: { total: 2000, out: 1245 }, zones: [], status: 'Active' },
            { id: 15, name: 'Lanyard + Badge', type: 'onetime', perDay: false, totalAmount: null, inventory: { total: 500, out: 312 }, zones: [], status: 'Active' },
            { id: 16, name: 'Welcome Pack', type: 'onetime', perDay: false, totalAmount: null, inventory: { total: 400, out: 234 }, zones: [], status: 'Active' },
          ],
          perks: [
            { id: 17, name: 'Merchandise Bag', type: 'onetime', perDay: false, totalAmount: null, inventory: { total: 250, out: 189 }, zones: [], status: 'Active' },
            { id: 18, name: 'VIP Lounge Access', type: 'access', perDay: false, totalAmount: null, inventory: null, zones: ['VIP Area', 'Artist Lounge'], status: 'Active' },
          ],
        },
        showToast(msg) { this.toast = msg; setTimeout(() => this.toast = null, 3000); },
        get currentCategory() {
          return this.categories.find(c => c.id === this.selectedCategory) || this.categories[0];
        },
        get currentItems() {
          return this.items[this.selectedCategory] || [];
        },
      };
    }
  </script>
</body>
</html>